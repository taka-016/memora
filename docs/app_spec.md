# アプリケーション仕様書

## アプリケーション概要

- ユーザーが家族などのグループ内での過去と未来のイベントを記録・共有できるアプリケーション
- メイン機能は以下の情報を年表形式で俯瞰する画面
  - グループのイベント・旅行
  - 個人のイベント

## ユーザーストーリー

[user_stories](./user_stories.md)を参照

## ユースケース図

[usecase_diagram.md](./usecase_diagram.md)を参照

## データ構造

[er_diagram.md](./er_diagram.md)を参照

## 機能要件

### 認証・アカウント管理機能

- Google Cloud Identity Platform（Firebase Auth）を使用した認証システム
- Google認証とメールアドレス/パスワード認証の両方をサポート
- ユーザーアカウント（User）とアプリケーション内のメンバー（Member）の分離
- アカウント登録・ログイン・ログアウト機能
- アカウント管理機能（メールアドレス変更、パスワード変更、アカウント削除）
- パスワードポリシー：大文字、小文字、特殊文字、数字を含む8文字以上
- ログイン状態の維持
- セキュリティエラーハンドリング

### 招待機能

- 招待URL生成機能（有効期限24時間）
- 招待URLによるアカウント登録
- 招待時の自動メンバー紐づけ
- 招待URL有効期限管理
- 無効招待URLのエラーハンドリング

### メンバー管理機能

- メンバーの作成・編集・削除機能
- メンバー一覧表示（表示名順）
- メンバーとグループという概念があり、グループに1人以上のメンバーが所属する
- メンバーは複数のグループに所属することが可能
- メンバーの編集・削除権限はメンバーを作成したアカウントに紐づく
- メンバー情報の更新（表示名変更等）
- 必須項目バリデーション（表示名必須）

### グループ管理機能

- グループの作成・編集・削除機能
- グループ一覧表示（グループ名順）
- グループへのメンバー追加・削除機能
- グループ作成時に作成者を自動所属
- グループの編集・削除権限はグループを作成したアカウントに紐づく
- グループ名の更新
- 必須項目バリデーション（グループ名必須）
- 削除確認ダイアログ

### 年表表示機能

- グループ単位での年表表示
- 時系列によるイベント・旅行・ライフイベントの統合表示
- 過去・現在・未来の年の表示
- 年単位での列分割
- イベント・旅行・個人イベントの行分割
- 行の高さ調整機能（ドラッグ操作）
- 所属グループの年表アクセス
- 所属グループなしの場合のメッセージ表示

### グループイベント管理機能

- 年表上でのイベント作成・編集・削除
- イベント設定画面からのイベント一覧表示
- イベント情報（名前、日付）の管理
- 必須項目バリデーション（イベント名、日付）
- 日付順での並び替え
- 年表上でのイベント確認
- 削除確認ダイアログ

### 旅行管理機能

- 年表上での旅行作成・編集・削除
- 旅行管理画面からの旅行一覧表示
- 旅行情報（名前、開始日、終了日）の管理
- 必須項目バリデーション（旅行名、日付）
- 日付範囲バリデーション（開始日 < 終了日）
- 日付順での並び替え
- 年表上での旅行確認
- 訪問場所の追加・管理
- 訪問場所の順序入れ替え（ドラッグ操作）
- 訪問日時の設定
- 削除確認ダイアログ

### ライフイベント表示機能

- メンバーの生年月日からライフイベントの自動計算・表示
- 七五三、学校入学/卒業、成人式等の表示
- 未来のライフイベントのみ表示
- 表示専用（データとして自動登録しない）

### マップ機能

- Google Maps統合
- 位置情報（pin）の作成・表示・削除
- 地図検索機能（場所名による検索）
- マップ上での手動位置選択
- ピンタップによる旅行詳細情報表示
- 同一場所の過去の訪問記録一覧表示
- 同一旅行の訪問場所まとめ表示
- 地図操作（ピンチ/ドラッグによる拡大・縮小・移動）
- マップからの旅行情報編集アクセス
- 複数訪問場所の管理
- 訪問場所の詳細情報（訪問期間、メモ）
- 旅行情報（trip_entry）には位置情報（pin）が紐づく

### 検索・フィルタリング機能

- イベント名による検索
- 旅行名による検索
- 検索結果のハイライト表示
- 日付範囲によるフィルタリング
- 参加者によるフィルタリング
- 検索結果なしの場合のメッセージ表示
- 検索条件変更の提案表示

### UI/UX機能

- 直感的なユーザーインターフェース
- ハンバーガーメニューによる機能アクセス
- トップページでの年表表示（デフォルト画面）
- 各機能はウィジェット化されており、トップページ上で切り替え表示
- 画面遷移の分かりやすさ（タイトル表示、戻るボタン）
- ローディング状態の表示
- 具体的で分かりやすいエラーメッセージ
- エラー解決方法の提示

### メニュー構成

- ハンバーガーメニュー項目：
  - グループ年表
  - マップ表示
  - グループ管理
  - メンバー管理
  - アカウント設定
  - ログアウト
